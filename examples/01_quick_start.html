

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<meta content="metadata description" lang="en" name="description" xml:lang="en" />
<meta content="Sphinx, MyST" name="keywords" />
<meta content="en_US" property="og:locale" />

    <title>SAX Quick Start &#8212; sax 0.11.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/css/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"21c88eb1cbb74625beda241b673c3bfe": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_fb2ea3539695455e90c84590518e13f3", "placeholder": "\u200b", "style": "IPY_MODEL_cf40d7485f3840a19e8928468c201a94", "tabbable": null, "tooltip": null, "value": " 300/300 [00:04&lt;00:00, 82.88it/s, loss=0.000000]"}}, "3aebff9f374048efb67592a934c3d2fb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "5b2fea67ee37467a99f5321a28bc488a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8746b536393e49fc848fca7c1a2a95f5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_d54fb42fc30341e5805cd49d4852d46d", "IPY_MODEL_c36b9ee64dc84e0099f293252308b198", "IPY_MODEL_21c88eb1cbb74625beda241b673c3bfe"], "layout": "IPY_MODEL_5b2fea67ee37467a99f5321a28bc488a", "tabbable": null, "tooltip": null}}, "ba9a2148d64d453bacded50889a38c4d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "c36b9ee64dc84e0099f293252308b198": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_ddd8fbb1f0604b9e88549abb8a4c0dff", "max": 300.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_ba9a2148d64d453bacded50889a38c4d", "tabbable": null, "tooltip": null, "value": 300.0}}, "cf40d7485f3840a19e8928468c201a94": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "d54fb42fc30341e5805cd49d4852d46d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_fa45cec1a0c840b79196fba75c267b5d", "placeholder": "\u200b", "style": "IPY_MODEL_3aebff9f374048efb67592a934c3d2fb", "tabbable": null, "tooltip": null, "value": "100%"}}, "ddd8fbb1f0604b9e88549abb8a4c0dff": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fa45cec1a0c840b79196fba75c267b5d": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fb2ea3539695455e90c84590518e13f3": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/01_quick_start';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Simulating an All-Pass Filter" href="02_all_pass_filter.html" />
    <link rel="prev" title="SAX" href="../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="sax 0.11.2 documentation - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="sax 0.11.2 documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Home</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../index.html">SAX</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">SAX Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_all_pass_filter.html">Simulating an All-Pass Filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_circuit_from_yaml.html">Circuit from YAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_multimode_simulations.html">Multimode simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_thinfilm.html">Thin film optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_additive_backend.html">Additive Backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_layout_aware.html">Layout Aware Monte Carlo with GDSFactory</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Library Internals</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../internals/01_models.html">Models and Model Factories</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internals/02_circuit.html">Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internals/03_backends.html">Backends</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../sax.html">sax package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../sax.backends.html">sax.backends package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../sax.backends.additive.html">sax.backends.additive module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sax.backends.filipsson_gunnar.html">sax.backends.filipsson_gunnar module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sax.backends.klu.html">sax.backends.klu module</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../sax.nn.html">sax.nn package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../sax.nn.core.html">sax.nn.core module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sax.nn.io.html">sax.nn.io module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sax.nn.loss.html">sax.nn.loss module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sax.nn.utils.html">sax.nn.utils module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sax.circuit.html">sax.circuit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sax.models.html">sax.models module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sax.multimode.html">sax.multimode module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sax.netlist.html">sax.netlist module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sax.patched.html">sax.patched module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sax.saxtypes.html">sax.saxtypes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sax.utils.html">sax.utils module</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/flaport/sax/main?urlpath=lab/tree/examples/01_quick_start.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/flaport/sax/blob/main/examples/01_quick_start.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/flaport/sax" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/flaport/sax/edit/main/examples/01_quick_start.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/flaport/sax/issues/new?title=Issue%20on%20page%20%2Fexamples/01_quick_start.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/examples/01_quick_start.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SAX Quick Start</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-variables">Environment variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-dictionaries">Scatter <em>dictionaries</em></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametrized-models">Parametrized Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#circuit-models">Circuit Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-the-parametrized-mzi">Simulating the parametrized MZI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization">Optimization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mzi-chain">MZI Chain</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="sax-quick-start">
<h1>SAX Quick Start<a class="headerlink" href="#sax-quick-start" title="Permalink to this heading">#</a></h1>
<blockquote>
<div><p>Let’s go over the core functionality of SAX.</p>
</div></blockquote>
<section id="environment-variables">
<h2>Environment variables<a class="headerlink" href="#environment-variables" title="Permalink to this heading">#</a></h2>
<p>SAX is based on JAX… here are some useful environment variables for working with JAX:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># select float32 or float64 as default dtype</span>
<span class="o">%</span><span class="k">env</span> JAX_ENABLE_X64=0

<span class="c1"># select cpu or gpu</span>
<span class="o">%</span><span class="k">env</span> JAX_PLATFORM_NAME=cpu

<span class="c1"># set custom CUDA location for gpu:</span>
<span class="o">%</span><span class="k">env</span> XLA_FLAGS=--xla_gpu_cuda_data_dir=/usr/lib/cuda

<span class="c1"># Using GPU?</span>
<span class="kn">from</span> <span class="nn">jax.lib</span> <span class="kn">import</span> <span class="n">xla_bridge</span>

<span class="nb">print</span><span class="p">(</span><span class="n">xla_bridge</span><span class="o">.</span><span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">platform</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>env: JAX_ENABLE_X64=0
env: JAX_PLATFORM_NAME=cpu
env: XLA_FLAGS=--xla_gpu_cuda_data_dir=/usr/lib/cuda
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cpu
</pre></div>
</div>
</div>
</div>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">import</span> <span class="nn">jax.example_libraries.optimizers</span> <span class="k">as</span> <span class="nn">opt</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># plotting</span>
<span class="kn">import</span> <span class="nn">sax</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">trange</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="scatter-dictionaries">
<h2>Scatter <em>dictionaries</em><a class="headerlink" href="#scatter-dictionaries" title="Permalink to this heading">#</a></h2>
<p>The core datastructure for specifying scatter parameters in SAX is a dictionary… more specifically a dictionary which maps a port combination (2-tuple) to a scatter parameter (or an array of scatter parameters when considering multiple wavelengths for example). Such a specific dictionary mapping is called ann <code class="docutils literal notranslate"><span class="pre">SDict</span></code> in SAX (<code class="docutils literal notranslate"><span class="pre">SDict</span> <span class="pre">≈</span> <span class="pre">Dict[Tuple[str,str],</span> <span class="pre">float]</span></code>).</p>
<p>Dictionaries are in fact much better suited for characterizing S-parameters than, say, (jax-)numpy arrays due to the inherent sparse nature of scatter parameters. Moreover, dictonaries allow for string indexing, which makes them much more pleasant to use in this context. Let’s for example create an <code class="docutils literal notranslate"><span class="pre">SDict</span></code> for a 50/50 coupler:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">in1</span>          <span class="n">out1</span>
   \        <span class="o">/</span>
    <span class="o">========</span>
   <span class="o">/</span>        \
<span class="n">in0</span>          <span class="n">out0</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coupling</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">kappa</span> <span class="o">=</span> <span class="n">coupling</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">tau</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">coupling</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
<span class="n">coupler_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="n">tau</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;out0&quot;</span><span class="p">,</span> <span class="s2">&quot;in0&quot;</span><span class="p">):</span> <span class="n">tau</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out1&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kappa</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;out1&quot;</span><span class="p">,</span> <span class="s2">&quot;in0&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kappa</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kappa</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;out0&quot;</span><span class="p">,</span> <span class="s2">&quot;in1&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kappa</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;out1&quot;</span><span class="p">):</span> <span class="n">tau</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;out1&quot;</span><span class="p">,</span> <span class="s2">&quot;in1&quot;</span><span class="p">):</span> <span class="n">tau</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">coupler_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;in0&#39;, &#39;out0&#39;): 0.7071067811865476,
 (&#39;out0&#39;, &#39;in0&#39;): 0.7071067811865476,
 (&#39;in0&#39;, &#39;out1&#39;): 0.7071067811865476j,
 (&#39;out1&#39;, &#39;in0&#39;): 0.7071067811865476j,
 (&#39;in1&#39;, &#39;out0&#39;): 0.7071067811865476j,
 (&#39;out0&#39;, &#39;in1&#39;): 0.7071067811865476j,
 (&#39;in1&#39;, &#39;out1&#39;): 0.7071067811865476,
 (&#39;out1&#39;, &#39;in1&#39;): 0.7071067811865476}
</pre></div>
</div>
</div>
</div>
<p>Only the non-zero port combinations need to be specified. Any non-existent port-combination (for example <code class="docutils literal notranslate"><span class="pre">(&quot;in0&quot;,</span> <span class="pre">&quot;in1&quot;)</span></code>) is considered to be zero by SAX.</p>
<p>Obviously, it can still be tedious to specify every port in the circuit manually. SAX therefore offers the <code class="docutils literal notranslate"><span class="pre">reciprocal</span></code> function, which auto-fills the reverse connection if the forward connection exist. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coupler_dict</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="n">tau</span><span class="p">,</span>
        <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out1&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kappa</span><span class="p">,</span>
        <span class="p">(</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kappa</span><span class="p">,</span>
        <span class="p">(</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;out1&quot;</span><span class="p">):</span> <span class="n">tau</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">coupler_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;in0&#39;, &#39;out0&#39;): 0.7071067811865476,
 (&#39;in0&#39;, &#39;out1&#39;): 0.7071067811865476j,
 (&#39;in1&#39;, &#39;out0&#39;): 0.7071067811865476j,
 (&#39;in1&#39;, &#39;out1&#39;): 0.7071067811865476,
 (&#39;out0&#39;, &#39;in0&#39;): 0.7071067811865476,
 (&#39;out1&#39;, &#39;in0&#39;): 0.7071067811865476j,
 (&#39;out0&#39;, &#39;in1&#39;): 0.7071067811865476j,
 (&#39;out1&#39;, &#39;in1&#39;): 0.7071067811865476}
</pre></div>
</div>
</div>
</div>
</section>
<section id="parametrized-models">
<h2>Parametrized Models<a class="headerlink" href="#parametrized-models" title="Permalink to this heading">#</a></h2>
<p>Constructing such an <code class="docutils literal notranslate"><span class="pre">SDict</span></code> is easy, however, usually we’re more interested in having parametrized models for our components. To parametrize the coupler <code class="docutils literal notranslate"><span class="pre">SDict</span></code>, just wrap it in a function to obtain a SAX <code class="docutils literal notranslate"><span class="pre">Model</span></code>, which is a keyword-only function mapping to an <code class="docutils literal notranslate"><span class="pre">SDict</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">coupler</span><span class="p">(</span><span class="n">coupling</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sax</span><span class="o">.</span><span class="n">SDict</span><span class="p">:</span>
    <span class="n">kappa</span> <span class="o">=</span> <span class="n">coupling</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">coupling</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="n">coupler_dict</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="n">tau</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out1&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kappa</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kappa</span><span class="p">,</span>
            <span class="p">(</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;out1&quot;</span><span class="p">):</span> <span class="n">tau</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">coupler_dict</span>


<span class="n">coupler</span><span class="p">(</span><span class="n">coupling</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;in0&#39;, &#39;out0&#39;): 0.8366600265340756,
 (&#39;in0&#39;, &#39;out1&#39;): 0.5477225575051661j,
 (&#39;in1&#39;, &#39;out0&#39;): 0.5477225575051661j,
 (&#39;in1&#39;, &#39;out1&#39;): 0.8366600265340756,
 (&#39;out0&#39;, &#39;in0&#39;): 0.8366600265340756,
 (&#39;out1&#39;, &#39;in0&#39;): 0.5477225575051661j,
 (&#39;out0&#39;, &#39;in1&#39;): 0.5477225575051661j,
 (&#39;out1&#39;, &#39;in1&#39;): 0.8366600265340756}
</pre></div>
</div>
</div>
</div>
<p>We can define a waveguide in the same way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">waveguide</span><span class="p">(</span><span class="n">wl</span><span class="o">=</span><span class="mf">1.55</span><span class="p">,</span> <span class="n">wl0</span><span class="o">=</span><span class="mf">1.55</span><span class="p">,</span> <span class="n">neff</span><span class="o">=</span><span class="mf">2.34</span><span class="p">,</span> <span class="n">ng</span><span class="o">=</span><span class="mf">3.4</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sax</span><span class="o">.</span><span class="n">SDict</span><span class="p">:</span>
    <span class="n">dwl</span> <span class="o">=</span> <span class="n">wl</span> <span class="o">-</span> <span class="n">wl0</span>
    <span class="n">dneff_dwl</span> <span class="o">=</span> <span class="p">(</span><span class="n">ng</span> <span class="o">-</span> <span class="n">neff</span><span class="p">)</span> <span class="o">/</span> <span class="n">wl0</span>
    <span class="n">neff</span> <span class="o">=</span> <span class="n">neff</span> <span class="o">-</span> <span class="n">dwl</span> <span class="o">*</span> <span class="n">dneff_dwl</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">neff</span> <span class="o">*</span> <span class="n">length</span> <span class="o">/</span> <span class="n">wl</span>
    <span class="n">transmission</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">loss</span> <span class="o">*</span> <span class="n">length</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phase</span><span class="p">)</span>
    <span class="n">sdict</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="p">(</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">):</span> <span class="n">transmission</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">sdict</span>
</pre></div>
</div>
</div>
</div>
<p>That’s pretty straightforward. Let’s now move on to parametrized circuits:</p>
</section>
<section id="circuit-models">
<h2>Circuit Models<a class="headerlink" href="#circuit-models" title="Permalink to this heading">#</a></h2>
<p>Existing models can now be combined into a circuit using <code class="docutils literal notranslate"><span class="pre">sax.circuit</span></code>, which basically creates a new <code class="docutils literal notranslate"><span class="pre">Model</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mzi</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">circuit</span><span class="p">(</span>
    <span class="n">netlist</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;lft&quot;</span><span class="p">:</span> <span class="s2">&quot;coupler&quot;</span><span class="p">,</span>
            <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="s2">&quot;waveguide&quot;</span><span class="p">,</span>
            <span class="s2">&quot;btm&quot;</span><span class="p">:</span> <span class="s2">&quot;waveguide&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rgt&quot;</span><span class="p">:</span> <span class="s2">&quot;coupler&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;connections&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;lft,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;btm,in0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;btm,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,in0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lft,out1&quot;</span><span class="p">:</span> <span class="s2">&quot;top,in0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;top,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,in1&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="s2">&quot;lft,in0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in1&quot;</span><span class="p">:</span> <span class="s2">&quot;lft,in1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,out0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out1&quot;</span><span class="p">:</span> <span class="s2">&quot;rgt,out1&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="n">models</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;coupler&quot;</span><span class="p">:</span> <span class="n">coupler</span><span class="p">,</span>
        <span class="s2">&quot;waveguide&quot;</span><span class="p">:</span> <span class="n">waveguide</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">?</span>mzi
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">circuit</span></code> function just creates a similar function as we created for the waveguide and the coupler, but in stead of taking parameters directly it takes parameter <em>dictionaries</em> for each of the instances in the circuit. The keys in these parameter dictionaries should correspond to the keyword arguments of each individual subcomponent.</p>
<p>Let’s now do a simulation for the MZI we just constructed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> mzi()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 238 ms, sys: 8.4 ms, total: 247 ms
Wall time: 244 ms
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;in0&#39;, &#39;in0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in0&#39;, &#39;in1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in0&#39;, &#39;out0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in0&#39;, &#39;out1&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;in1&#39;, &#39;in0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in1&#39;, &#39;in1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in1&#39;, &#39;out0&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;in1&#39;, &#39;out1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out0&#39;, &#39;in0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out0&#39;, &#39;in1&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;out0&#39;, &#39;out0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out0&#39;, &#39;out1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out1&#39;, &#39;in0&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;out1&#39;, &#39;in1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out1&#39;, &#39;out0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out1&#39;, &#39;out1&#39;): Array(0.+0.j, dtype=complex128)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mzi2</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">mzi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> mzi2()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 97 ms, sys: 1.09 ms, total: 98.1 ms
Wall time: 98.2 ms
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;in0&#39;, &#39;in0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in0&#39;, &#39;in1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in0&#39;, &#39;out0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in0&#39;, &#39;out1&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;in1&#39;, &#39;in0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in1&#39;, &#39;in1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in1&#39;, &#39;out0&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;in1&#39;, &#39;out1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out0&#39;, &#39;in0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out0&#39;, &#39;in1&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;out0&#39;, &#39;out0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out0&#39;, &#39;out1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out1&#39;, &#39;in0&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;out1&#39;, &#39;in1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out1&#39;, &#39;out0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out1&#39;, &#39;out1&#39;): Array(0.+0.j, dtype=complex128)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> mzi2()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 318 µs, sys: 0 ns, total: 318 µs
Wall time: 208 µs
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;in0&#39;, &#39;in0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in0&#39;, &#39;in1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in0&#39;, &#39;out0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in0&#39;, &#39;out1&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;in1&#39;, &#39;in0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in1&#39;, &#39;in1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in1&#39;, &#39;out0&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;in1&#39;, &#39;out1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out0&#39;, &#39;in0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out0&#39;, &#39;in1&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;out0&#39;, &#39;out0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out0&#39;, &#39;out1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out1&#39;, &#39;in0&#39;): Array(-0.57126822+0.82076344j, dtype=complex128),
 (&#39;out1&#39;, &#39;in1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out1&#39;, &#39;out0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out1&#39;, &#39;out1&#39;): Array(0.+0.j, dtype=complex128)}
</pre></div>
</div>
</div>
</div>
<p>Or in the case we want an MZI with different arm lengths:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mzi</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mf">25.0</span><span class="p">},</span> <span class="n">btm</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;in0&#39;, &#39;in0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in0&#39;, &#39;in1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in0&#39;, &#39;out0&#39;): Array(-0.28072841+0.10397039j, dtype=complex128),
 (&#39;in0&#39;, &#39;out1&#39;): Array(0.89474612-0.33137758j, dtype=complex128),
 (&#39;in1&#39;, &#39;in0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in1&#39;, &#39;in1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;in1&#39;, &#39;out0&#39;): Array(0.89474612-0.33137758j, dtype=complex128),
 (&#39;in1&#39;, &#39;out1&#39;): Array(0.28072841-0.10397039j, dtype=complex128),
 (&#39;out0&#39;, &#39;in0&#39;): Array(-0.28072841+0.10397039j, dtype=complex128),
 (&#39;out0&#39;, &#39;in1&#39;): Array(0.89474612-0.33137758j, dtype=complex128),
 (&#39;out0&#39;, &#39;out0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out0&#39;, &#39;out1&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out1&#39;, &#39;in0&#39;): Array(0.89474612-0.33137758j, dtype=complex128),
 (&#39;out1&#39;, &#39;in1&#39;): Array(0.28072841-0.10397039j, dtype=complex128),
 (&#39;out1&#39;, &#39;out0&#39;): Array(0.+0.j, dtype=complex128),
 (&#39;out1&#39;, &#39;out1&#39;): Array(0.+0.j, dtype=complex128)}
</pre></div>
</div>
</div>
</div>
</section>
<section id="simulating-the-parametrized-mzi">
<h2>Simulating the parametrized MZI<a class="headerlink" href="#simulating-the-parametrized-mzi" title="Permalink to this heading">#</a></h2>
<p>We can simulate the above mzi for multiple wavelengths as well by specifying the wavelength at the top level of the circuit call. Each setting specified at the top level of the circuit call will be propagated to all subcomponents of the circuit which have that setting:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.51</span><span class="p">,</span> <span class="mf">1.59</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="o">%</span><span class="k">time</span> S = mzi(wl=wl, top={&quot;length&quot;: 25.0}, btm={&quot;length&quot;: 15.0})
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 364 ms, sys: 2.54 ms, total: 366 ms
Wall time: 363 ms
</pre></div>
</div>
</div>
</div>
<p>Let’s see what this gives:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wl</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;λ [nm]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/548cad6b8b1df287624a538eb89fba447d6ed09253708f158148b277054a9067.png" src="../_images/548cad6b8b1df287624a538eb89fba447d6ed09253708f158148b277054a9067.png" />
</div>
</div>
</section>
<section id="optimization">
<h2>Optimization<a class="headerlink" href="#optimization" title="Permalink to this heading">#</a></h2>
<p>We’d like to optimize an MZI such that one of the minima is at 1550nm. To do this, we need to define a loss function for the circuit at 1550nm. This function should take the parameters that you want to optimize as positional arguments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">loss_fn</span><span class="p">(</span><span class="n">delta_length</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">mzi</span><span class="p">(</span><span class="n">wl</span><span class="o">=</span><span class="mf">1.55</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mf">15.0</span> <span class="o">+</span> <span class="n">delta_length</span><span class="p">},</span> <span class="n">btm</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">})</span>
    <span class="k">return</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> loss_fn(10.0)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 87.3 ms, sys: 512 µs, total: 87.8 ms
Wall time: 84.9 ms
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Array(0.08961828, dtype=float64)
</pre></div>
</div>
</div>
</div>
<p>We can use this loss function to define a grad function which works on the parameters of the loss function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grad_fn</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span>
    <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span>
        <span class="n">loss_fn</span><span class="p">,</span>
        <span class="n">argnums</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># JAX gradient function for the first positional argument, jitted</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we need to define a JAX optimizer, which on its own is nothing more than three more functions:  an initialization function with which to initialize the optimizer state, an update function which will update the optimizer state (and with it the model parameters). The third function that’s being returned will give the model parameters given the optimizer state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">initial_delta_length</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">init_fn</span><span class="p">,</span> <span class="n">update_fn</span><span class="p">,</span> <span class="n">params_fn</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">adam</span><span class="p">(</span><span class="n">step_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">init_fn</span><span class="p">(</span><span class="n">initial_delta_length</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Given all this, a single training step can be defined:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">step_fn</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="n">params_fn</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
    <span class="n">grad</span> <span class="o">=</span> <span class="n">grad_fn</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">update_fn</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<p>And we can use this step function to start the training of the MZI:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">range_</span> <span class="o">=</span> <span class="n">trange</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">range_</span><span class="p">:</span>
    <span class="n">loss</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">step_fn</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
    <span class="n">range_</span><span class="o">.</span><span class="n">set_postfix</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "8746b536393e49fc848fca7c1a2a95f5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">delta_length</span> <span class="o">=</span> <span class="n">params_fn</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">delta_length</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Array(9.93589743, dtype=float64)
</pre></div>
</div>
</div>
</div>
<p>Let’s see what we’ve got over a range of wavelengths:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">mzi</span><span class="p">(</span><span class="n">wl</span><span class="o">=</span><span class="n">wl</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mf">15.0</span> <span class="o">+</span> <span class="n">delta_length</span><span class="p">},</span> <span class="n">btm</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mf">15.0</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wl</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s2">&quot;in1&quot;</span><span class="p">,</span> <span class="s2">&quot;out1&quot;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;λ [nm]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1550</span><span class="p">,</span> <span class="mi">1550</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a8d4f7d04f3c7c51eba80d2616606e6d5ad75c5f4185925d1d9715aa5c18f66a.png" src="../_images/a8d4f7d04f3c7c51eba80d2616606e6d5ad75c5f4185925d1d9715aa5c18f66a.png" />
</div>
</div>
<p>The minimum of the MZI is perfectly located at 1550nm.</p>
</section>
<section id="mzi-chain">
<h2>MZI Chain<a class="headerlink" href="#mzi-chain" title="Permalink to this heading">#</a></h2>
<p>Let’s now create a chain of MZIs. For this, we first create a subcomponent: a directional coupler with arms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>                                 <span class="n">top</span>
                            <span class="n">in0</span> <span class="o">-----</span> <span class="n">out0</span> <span class="o">-&gt;</span> <span class="n">out1</span>
    <span class="n">in1</span> <span class="o">&lt;-</span> <span class="n">in1</span>        <span class="n">out1</span>                 
              \  <span class="n">dc</span>  <span class="o">/</span>                  
               <span class="o">======</span>                  
              <span class="o">/</span>      \                
    <span class="n">in0</span> <span class="o">&lt;-</span> <span class="n">in0</span>        <span class="n">out0</span>       <span class="n">btm</span>    
                            <span class="n">in0</span> <span class="o">-----</span> <span class="n">out0</span> <span class="o">-&gt;</span> <span class="n">out0</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc_with_arms</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">circuit</span><span class="p">(</span>
    <span class="n">netlist</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;lft&quot;</span><span class="p">:</span> <span class="s2">&quot;coupler&quot;</span><span class="p">,</span>
            <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="s2">&quot;waveguide&quot;</span><span class="p">,</span>
            <span class="s2">&quot;btm&quot;</span><span class="p">:</span> <span class="s2">&quot;waveguide&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;connections&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;lft,out0&quot;</span><span class="p">:</span> <span class="s2">&quot;btm,in0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lft,out1&quot;</span><span class="p">:</span> <span class="s2">&quot;top,in0&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="s2">&quot;lft,in0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;in1&quot;</span><span class="p">:</span> <span class="s2">&quot;lft,in1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="s2">&quot;btm,out0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;out1&quot;</span><span class="p">:</span> <span class="s2">&quot;top,out0&quot;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="n">models</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;coupler&quot;</span><span class="p">:</span> <span class="n">coupler</span><span class="p">,</span>
        <span class="s2">&quot;waveguide&quot;</span><span class="p">:</span> <span class="n">waveguide</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>An MZI chain can now be created by cascading these directional couplers with arms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">_</span>    <span class="n">_</span>    <span class="n">_</span>    <span class="n">_</span>             <span class="n">_</span>    <span class="n">_</span>  
    \<span class="o">/</span>   \<span class="o">/</span>   \<span class="o">/</span>   \<span class="o">/</span>     <span class="o">...</span>    \<span class="o">/</span>   \<span class="o">/</span>   
    <span class="o">/</span>\<span class="n">_</span>  <span class="o">/</span>\<span class="n">_</span>  <span class="o">/</span>\<span class="n">_</span>  <span class="o">/</span>\<span class="n">_</span>           <span class="o">/</span>\<span class="n">_</span>  <span class="o">/</span>\<span class="n">_</span>  
</pre></div>
</div>
<p>Let’s create a <em>model factory</em> (<code class="docutils literal notranslate"><span class="pre">ModelFactory</span></code>) for this. In SAX, a <em>model factory</em> is any keyword-only function that generates a <code class="docutils literal notranslate"><span class="pre">Model</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mzi_chain</span><span class="p">(</span><span class="n">num_mzis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">sax</span><span class="o">.</span><span class="n">Model</span><span class="p">:</span>
    <span class="n">chain</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">circuit</span><span class="p">(</span>
        <span class="n">netlist</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;dc</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="s2">&quot;dc_with_arms&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_mzis</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)},</span>
            <span class="s2">&quot;connections&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="o">**</span><span class="p">{</span><span class="sa">f</span><span class="s2">&quot;dc</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,out0&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;dc</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">,in0&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_mzis</span><span class="p">)},</span>
                <span class="o">**</span><span class="p">{</span><span class="sa">f</span><span class="s2">&quot;dc</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">,out1&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;dc</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">,in1&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_mzis</span><span class="p">)},</span>
            <span class="p">},</span>
            <span class="s2">&quot;ports&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;in0&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;dc0,in0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;in1&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;dc0,in1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out0&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;dc</span><span class="si">{</span><span class="n">num_mzis</span><span class="si">}</span><span class="s2">,out0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;out1&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;dc</span><span class="si">{</span><span class="n">num_mzis</span><span class="si">}</span><span class="s2">,out1&quot;</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">},</span>
        <span class="n">models</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;dc_with_arms&quot;</span><span class="p">:</span> <span class="n">dc_with_arms</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">chain</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s for example create a chain with 15 MZIs. We can also update the settings dictionary as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chain</span> <span class="o">=</span> <span class="n">mzi_chain</span><span class="p">(</span><span class="n">num_mzis</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">settings</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">get_settings</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
<span class="k">for</span> <span class="n">dc</span> <span class="ow">in</span> <span class="n">settings</span><span class="p">:</span>
    <span class="n">settings</span><span class="p">[</span><span class="n">dc</span><span class="p">][</span><span class="s2">&quot;top&quot;</span><span class="p">][</span><span class="s2">&quot;length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">25.0</span>
    <span class="n">settings</span><span class="p">[</span><span class="n">dc</span><span class="p">][</span><span class="s2">&quot;btm&quot;</span><span class="p">][</span><span class="s2">&quot;length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">15.0</span>
<span class="n">settings</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="n">wl</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>We can simulate this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> S = chain(**settings) # time to evaluate the MZI
<span class="n">func</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
<span class="o">%</span><span class="k">time</span> S = func(**settings) # time to jit the MZI
<span class="o">%</span><span class="k">time</span> S = func(**settings) # time to evaluate the MZI after jitting
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 660 ms, sys: 43.9 ms, total: 704 ms
Wall time: 699 ms
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 2.42 s, sys: 10.5 ms, total: 2.43 s
Wall time: 2.42 s
CPU times: user 41.6 ms, sys: 20.2 ms, total: 61.8 ms
Wall time: 59.8 ms
</pre></div>
</div>
</div>
</div>
<p>Where we see that the unjitted evaluation of the MZI chain takes about a second, while the jitting of the MZI chain takes about two minutes (on a CPU). However, after the MZI chain has been jitted, the evaluation is in the order of about a few milliseconds!</p>
<p>Anyway, let’s see what this gives:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">sax</span><span class="o">.</span><span class="n">sdict</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mf">1e3</span> <span class="o">*</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;dc0&quot;</span><span class="p">][</span><span class="s2">&quot;top&quot;</span><span class="p">][</span><span class="s2">&quot;wl&quot;</span><span class="p">],</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="s2">&quot;in0&quot;</span><span class="p">,</span> <span class="s2">&quot;out0&quot;</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;λ [nm]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6e464b885a0c2686ba186fbce7be8dafc92057eb4fb3caa426b3277d296a37a9.png" src="../_images/6e464b885a0c2686ba186fbce7be8dafc92057eb4fb3caa426b3277d296a37a9.png" />
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">SAX</p>
      </div>
    </a>
    <a class="right-next"
       href="02_all_pass_filter.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Simulating an All-Pass Filter</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-variables">Environment variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scatter-dictionaries">Scatter <em>dictionaries</em></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametrized-models">Parametrized Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#circuit-models">Circuit Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulating-the-parametrized-mzi">Simulating the parametrized MZI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization">Optimization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mzi-chain">MZI Chain</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Floris Laporte
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, Apache2.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>